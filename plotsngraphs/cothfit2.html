<!DOCTYPE html>
<html>
<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src = "https://cdnjs.cloudflare.com/ajax/libs/mathjs/3.12.1/math.js"></script>
<script>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
</head>
<body>
<div id = "sampledata" style = "display:none;">151.5386090666399
152.5231823276875
163.79334268464078
153.5566121780542
161.15632661532732
149.88673586294397
150.78124427437396
163.99967335296057
160.3661630448341
151.783752542774
154.95916718380977
160.35587089236432
163.41939331705584
162.64405404223604
163.84878881246019
167.22677782418208
173.24511054411312
162.74802344639815
170.5817425489602
171.68821386154815
173.29042294922593
167.09347407332635
177.05978268521505
170.74565673363452
173.9627164406474
172.17688157543836
176.04471172571485
176.68265359629925
177.10028447577417
173.31428780294505
182.77759870654182
184.76394349752795
184.37853347765926
179.18870959460648
185.9452774266387
191.25738821605333
191.3646279915708
187.20612548961677
188.18506180130885
190.6414738886009
196.15540731615786
186.15997984398845
182.26551433169678
186.10205559527617
196.7308623744412
193.52454978406573
191.63092653845354
197.70219359368377
197.86304241421422
199.78788088730286
199.99516292497083
184.18587632311983
202.9914806160617
198.07923543446032
202.20149588163645
206.49924463942335
204.13094835324404
209.53474171086086
213.5327979787251
209.58864354122528
213.21282594283213
205.5301389917574
201.23472252115965
214.1839147287542
202.9883078747268
228.2072778919322
208.33380393496626
214.56883001470982
209.56682965204402
219.35588071223248
213.5260321334001
226.02166358584662
224.2575768651086
221.70732764813587
212.4361997164635
233.1813963893454
224.07593292899992
236.2595773742308
229.95905713636654
231.99272988107927
219.61113401836133
230.46486031056332
228.87497006865215
229.19217177804842
237.66207618100077
231.25146073736374
228.84919465688535
235.48624290381107
231.54489112800366
246.01796566862853
238.451343700693
241.34677238892704
239.04466621818588
240.25920326852435
243.8942380041695
233.48984868652147
242.2401691797634
237.61154716389993
249.41297068179233
250.8688308163338
256.51862681300713
246.40864498438398
253.19736580819614
254.35280367664822
255.48896202243563
261.9108885175069
257.2060588165822
258.85203029310156
254.21518806420988
263.8121646435242
262.0750585246543
256.9754665548603
268.9385378198539
259.7901756294766
263.57500565349744
272.090825981535
264.8291780473646
273.814285627108
264.43382432606705
261.6635631965541
281.3525189851633
272.57618062768523
272.0064339740319
276.4341865296441
281.0475833290703
284.2034717853531
276.03024958056835
276.7154459307885
272.89781438332056
280.35957231996656
270.2732692799369
282.24642897934467
281.4863638921347
274.3801270958054
278.597052928837
283.7729528424853
295.78661106692863
284.1849227719544
292.98828718189685
280.9425070008003
282.93784796158684
294.03778810743563
287.2348251094131
289.5408736388679
289.52605103500866
292.05483080874967
289.990901837043
295.7281331406407
290.59660516731833
288.7201595640122
290.38154571787726
293.80935990851333
301.79686282724145
294.51791240804204
301.5461253820684
300.5005157961605
303.0784671060729
302.63276920390365
293.8831755541628
307.6355845936247
310.2385459162118
304.6139684086186
302.9647140156921
308.1779604327337
314.5887397273018
315.3345104523656
307.6312473068165
302.2962352053775
300.85655044784943
310.0036609850062
316.90567785103343
308.0691355413729
319.56792477692073
316.85959858398826
315.07199497349774
313.8355931560244
316.70701954850267
319.4931213977164
321.640810402666
329.9845968073126
318.67687190556893
321.48600163092146
325.0343008221623
317.75210936758583
318.21356384070873
320.7910102299131
326.37153193886485
332.2399867978534
322.9928598482952
333.54972063011394
333.2536577626002
331.94685504034356
333.28179964644875
336.5145327250108
324.8722187142768
333.54972215829866
328.2543629656238
336.0285431010952
333.09653357784674
326.0287672138879
335.67465251748354
333.41134969465776
326.7372278669299
333.89639737027557
338.8154424831928
336.75949448420357
344.4198588158469
342.6006830796861
347.2615824904947
343.70596139949896
342.0180107885251
340.25961661247186
343.44824447805706
339.2655786581319
339.20709759534753
346.4433478805682
348.18973206509014
352.17507865275473
339.8109077277801
348.0726073614306
336.83393047242527
331.94902210474936
340.09941009719915
351.03224645746366
347.2451370957996
350.55683928987554
354.61804261945076
340.76591366673426
347.28724563170124
349.4396705195428
349.8406197629777
348.3148417324546
359.4040178685745
359.27817510121827
347.8262292566181
349.81230283692713
347.38131690921654
343.665986774517
346.3578074181002
344.9230240095732
346.0350772197091
343.2073679377925
353.03468458026407
352.5477376352794
336.76409220599436
341.7116973068143
354.17965682786814
341.24095459496095
351.4092389037656
348.24740497286064
344.19352772455983
356.6995529883242
351.69662980859306
354.43563850252787
349.19549468427175
354.17916579864317
346.03401764391253
349.40451578999256
350.61416446641516
352.2735082648448
350.4126036478624
357.4476839825576
347.12332402427916
350.4546448170183
352.5365475613768
354.6858446596856
349.5555517110079
340.24412398431264
355.1645145871028
338.5427934027688
343.3233380553273
345.6821909562887
342.2580840459088
338.31294043145573
345.0707218816045
346.24142523417555
341.4680173204228
339.05429410517
336.8439197003678
351.7478085065272
342.94469375023965
347.88941249586225
344.6239162531953
342.4969288806973
341.61773307028636
351.6198489284571
335.78898305103826
342.04449530951064
336.77192883262086
340.7251641813521
343.3108846482545
334.3099509360928
338.1581472080636
333.08242307964963
330.54723509121726
339.793473176172
341.8940533678489
339.23849283473635
335.96130154387413
332.37059936972867
332.7585582334211
335.89139473701636
333.6783621682731
328.93574464796916
330.909657879811
326.3762212334201
345.09114787714924
329.02441429091584
327.56646347872874
332.4942792631958
324.67882427965674
330.90167334498346
323.27980216845276
332.504299808695
319.8592154473597
321.5387078618891
318.84273541238355
326.2915563277912
327.04521794930577
318.5487214973108
326.71521620601567
325.9642461673098
322.966186515766
319.4239037811944
312.73689075577164
321.04102453650705
319.4512113161094
313.15399721894335
307.87185220854764
306.73037926285417
317.43364677141625
313.34630010776215
301.4662011806508
306.012493027841
307.6998478816553
307.8483224771346
318.227678849815
312.5802978088765
308.84534883000276
313.02492857546565
311.83797540739926
312.57881634906676
299.80505281527377
304.8391838464532
304.0435525203995
301.0235401764621
300.9307546111991
293.05768506848796
303.42101292279676
295.41488080010777
293.03820246668425
298.2008980655034
294.02779628183026
298.47147065992897
285.72904747019345
296.74681444325336
293.6765096647185
276.79262697653655
292.84066862769646
278.9178216965541
286.02121990547323
291.04607508246653
283.70912007290696
285.6314328010568
296.2624990447013
285.24509269436675
284.0469176138919
280.37617230879295
285.5618217058045
279.14737161606166
279.20355911698283
266.3688261422441
284.3823163456221
276.03513033149187
272.3533054697002
276.5642343578637
286.5066265350183
269.82883935583425
267.803046660112
268.7082241177579
266.5961666599951
266.727942695534
263.77009677172776
265.1825198649285
270.0881459078263
262.82130045292
260.7016068801567
260.6553410396345
266.0535653817047
259.64660543269997
263.57898174178905
263.55517635160857
251.91057618931256
252.08939167014694
252.2230680755677
250.53690002574572
246.68226937298158
253.79795585170527
252.20315674649495
250.34366248539507
255.9406577725412
245.03616244389212
247.87849572834455
246.67105057744084
239.41774314071608
251.19537420772434
244.42073964140974
240.5070970191262
236.14258176111878
251.97129320937592
234.8819037401107
232.25982329048892
248.37153500728448
241.24942325308845
233.13351508661265
232.55711398004206
238.11678492526767
225.4905417528534
232.8381414193013
233.17635843247558
237.6813337046407
239.82202485159422
217.82508107347067
226.07273259288678
219.44538423449632
225.65687900750967
228.04996273278084
216.95705852340964
218.7931294410406
228.9024903551214
211.01694974972855
214.83767865338748
223.58095980570363
211.98623466135206
214.31620056612806
206.51537920172734
218.11547375313629
219.22939605581283
210.85963879533685
218.00373916159816
214.35365393018347
220.17675940755947
210.97860284287393
216.79302498943758
208.15662358558248
207.84270767475465
195.7388164585374
202.35491992806442
199.66605676184903
207.33366236950496
201.6403385712711
202.45816104022805
195.77256477154202
195.891383826373
199.6399874601735
192.07042496946826
197.19731814355887
192.33174967372062
185.22206794013582
192.47169398580175
187.19716552001256
189.814333216431
198.19347522512595
189.3057577055044
187.8889710881973
187.204867598419
189.30408094718817
192.60687894142157
187.65762780202834
179.93512605750908
175.69576655283112
167.6573597195418
179.29294937032273
181.2773037615463
186.0268809048547
171.99540188499026
166.56964546994286
175.84130255280306
167.9323829663457
169.9753252110667
172.20104784870048
181.24926018942273
169.37924878694156
156.431543701463
163.27728516119396
166.15477293138733
166.2331845585458
159.0273588586425
161.07347899568532
164.20008681231437
156.40877235849683
160.40397239545334
157.4000752138239
147.37885798088274
151.8776094706833
159.8383211297906
144.73652874119483
147.55645613623096
155.44564487458044
150.37484479681115
140.94340501773414
</div>   
    <table id = "inputs">
       <tr><td>T:</td><td><input id = "Tin" value = "50" onchange = "updateplot();"></input></td></tr> 
        <tr><td>T_N:</td><td><input id = "TNin" value = "0" onchange = "updateplot();"></input></td></tr>
        <tr><td>G:</td><td><input id = "Gin" value = "1" onchange = "updateplot();"></input></td></tr>
    </table>
    <canvas id = "plot1"></canvas>
    <canvas id = "res1"></canvas>
    <canvas id = "chi1"></canvas>
    <div id = "chisquaredout">0</div>
    <textarea id = "dataOUT"></textarea>
    <div id = "equationlabel">$$\chi^2(T,G)$$</div>
<script>
document.getElementById("dataOUT").value = document.getElementById("sampledata").innerHTML;
datastring =document.getElementById("dataOUT").value;
dataArray = datastring.split("\n");
n = dataArray.length;
plot1 = document.getElementById("plot1");
plot1.width = 500;
plot1.height = 400;
res1 = document.getElementById("res1");
res1.width = 500;
res1.height = 200;


plotchisquared(1,0,50,250);
Twave = [];
chiwave = [];

for(G = 0.8;G < 1.2;G += 0.01){
    for(T = 30;T < 70;T += 1){
        computechisquared(G,0,T,250);
        chiwave.push(chisquared);
    }
}

chiplot = document.getElementById("chi1");
chiplot.width = 400;
chiplot.height = 400;
ctx = chiplot.getContext("2d");


for(var index = 0;index < chiwave.length;index++){
    pixelx = index%40;
    pixely = Math.floor(index/40);
    fillstring = "#";
    fillstring += (Math.round(.1*chiwave[index]*3)).toString(16);
    fillstring += (Math.round(.1*chiwave[index]*3)).toString(16);
    fillstring += (Math.round(.1*chiwave[index]*3)).toString(16);
    ctx.fillStyle = fillstring;
    ctx.fillRect(10*pixelx,10*pixely,10,10);
}


function updateplot(){
    TN = document.getElementById("TNin").value;
    T = document.getElementById("Tin").value;
    G = document.getElementById("Gin").value;
    plotchisquared(G,TN,T,250);
}

function plotchisquared(G,TN,T,x0){
    plot1 = document.getElementById("plot1");
    ctx = plot1.getContext("2d");
    ctx.strokeStyle="black";
    ctx.lineWidth = 2;
    ctx.clearRect(0,0,600,400);
    ctx.beginPath();
    ctx.moveTo(0,dataArray[0]);
    for(var index = 0;index < n - 1;index++){
        ctx.lineTo(index,dataArray[index]);
    }
    ctx.stroke();
    ctx.closePath();
    ctx.strokeStyle="purple";

    ctx.beginPath();
    ctx.moveTo(0,400 - P(G,TN,T,x0,0));

    chisquared = 0;
    for(var index = 1;index < n - 1;index++){
        ctx.lineTo(index,400-P(G,TN,T,x0,index));
        chisquared += (400-P(G,TN,T,x0,index) - dataArray[index])*(400-P(G,TN,T,x0,index) - dataArray[index]);
    }
    sigma = 5;
    chisquared /= sigma*sigma;
    chisquared /= n - 2;
    ctx.stroke();
    ctx.closePath();
}

function computechisquared(G,TN,T,x0){
    chisquared = 0;
    for(var index = 1;index < n - 1;index++){
        chisquared += (400-P(G,TN,T,x0,index) - dataArray[index])*(400-P(G,TN,T,x0,index) - dataArray[index]);
    }
    sigma = 5;
    chisquared /= sigma*sigma;
    chisquared /= n - 2;
}

function P(G,TN,T,x0,x){
    return G*(TN + T*xcothx((x - x0)/T));
}

function xcothx(xin){
    if(xin != 0){
        yout = xin/Math.tanh(xin);
    }
    else{
        yout = 1;
    }
    return yout;
}


</script>
<style>
    html{
        background-color:yellow;
    }
    #plot1{
        position:absolute;
        right:50px;
        top:5px;
        background-color:white;
    }
    #res1{
        position:absolute;
        right:50px;
        bottom:10px;
        background-color:white;
    }
    #chi1{
        position:absolute;
        left:200px;
        top:100px;
        background-color:white;
    }
    #svgIO{
        position:absolute;
        bottom:5px;
        left:100px;
    }
    #inputs{
        border:solid;
        border-radius:15px;
        padding:15px 15px 15px 15px;
        background-color:greenyellow;
        position:absolute;
        left:50px;
        top:200px;
        display:none;
    }
    #chisquaredout{
        position:absolute;
        left:50px;
        top:5px;
        background-color:greenyellow;
        padding: 15px 15px 15px 15px;
        border-radius:15px;
            display:none;

    }
    #chieq{
        position:absolute;
        left:400px;
        top:5px;
        background-color:greenyellow;
        padding: 15px 15px 15px 15px;
        border-radius:15px;
    }
    #dataOUT{
        position:absolute;
        left:100px;
        bottom:100px;
    }
    #equationlabel{
        position:absolute;
        left:250px;
        top:200px;  
        color:yellow;
        font-size:30px; 
    }
</style>   
</body>
</html>