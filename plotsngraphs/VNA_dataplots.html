<!DOCTYPE html>
<html>
<body>
    <div id = "sampledata" style = "display:none">!CSV A.01.01
!Keysight Technologies,E5080A,MY55100528,A.11.00.09
!Date: Wednesday, May 25, 2016 22:34:00
!Source: Standard

BEGIN CH1_DATA
Freq(Hz),S21(DB),S21(DEG)
2000000000,28.107569,-174.47835
2003015075.3769,27.879023,139.81943
2006030150.7538,27.804672,96.535042
2009045226.1307,27.97706,50.269207
2012060301.5075,27.953905,4.8410139
2015075376.8844,28.139938,-42.135597
2018090452.2613,27.986977,-87.194626
2021105527.6382,28.093597,-133.31798
2024120603.0151,27.751051,-178.12773
2027135678.392,27.936787,138.42627
2030150753.7688,27.683744,92.44957
2033165829.1457,27.808313,47.824684
2036180904.5226,28.106518,0.37885278
2039195979.8995,28.111773,-45.379787
2042211055.2764,28.315025,-91.493134
2045226130.6533,27.735491,-137.26787
2048241206.0302,28.107399,175.88602
2051256281.407,27.704014,131.95059
2054271356.7839,27.854683,86.655518
2057286432.1608,27.854504,41.215172
2060301507.5377,27.970587,-4.9270115
2063316582.9146,28.236601,-51.133541
2066331658.2915,28.031235,-96.504951
2069346733.6683,27.905993,-142.7249
2072361809.0452,27.943426,172.88631
2075376884.4221,27.805473,127.44537
2078391959.799,27.948059,82.068932
2081407035.1759,27.999481,37.089497
2084422110.5528,28.167868,-9.6197777
2087437185.9296,28.175417,-54.113617
2090452261.3065,28.037497,-101.60079
2093467336.6834,28.174557,-146.34285
2096482412.0603,27.820757,166.72227
2099497487.4372,28.075893,121.46264
2102512562.8141,27.968945,76.109207
2105527638.191,27.860138,29.770441
2108542713.5678,27.827034,-14.303496
2111557788.9447,28.075409,-60.465328
2114572864.3216,28.015512,-107.11993
2117587939.6985,27.90382,-152.96274
2120603015.0754,28.044054,161.45952
2123618090.4523,27.78792,117.04352
2126633165.8291,27.754059,72.518936
2129648241.206,28.181753,27.735653
2132663316.5829,28.083937,-19.379938
2135678391.9598,27.994118,-66.319305
2138693467.3367,27.693586,-111.65815
2141708542.7136,27.632881,-160.16187
2144723618.0905,27.582447,157.37207
2147738693.4673,28.005291,111.64602
2150753768.8442,27.979048,66.098892
2153768844.2211,27.933455,21.598976
2156783919.598,27.920918,-26.510954
2159798994.9749,27.782228,-72.217865
2162814070.3518,27.714607,-118.01122
2165829145.7286,27.320562,-163.54492
2168844221.1055,27.492254,152.26086
2171859296.4824,27.467215,106.44806
2174874371.8593,27.732782,62.523811
2177889447.2362,27.694538,16.220245
2180904522.6131,27.83392,-29.92478
2183919597.9899,27.861383,-75.830231
2186934673.3668,27.616013,-123.84208
2189949748.7437,27.543903,-168.02751
2192964824.1206,27.313406,146.19392
2195979899.4975,27.536974,101.16766
2198994974.8744,27.700548,55.54665
2202010050.2513,27.683611,11.858385
2205025125.6281,27.708836,-34.672764
2208040201.005,27.737892,-79.837631
2211055276.3819,27.621796,-127.32097
2214070351.7588,27.703926,-171.99785
2217085427.1357,27.336674,143.02005
2220100502.5126,27.373198,97.149536
2223115577.8894,27.556622,50.555855
2226130653.2663,27.454821,4.4652386
2229145728.6432,27.526209,-41.21537
2232160804.0201,27.43808,-88.548241
2235175879.397,27.348053,-131.55975
2238190954.7739,26.986601,-177.47711
2241206030.1508,27.416468,137.28871
2244221105.5276,27.193047,92.507202
2247236180.9045,27.130743,47.411415
2250251256.2814,27.541981,1.1889249
2253266331.6583,27.445271,-46.089577
2256281407.0352,27.239008,-93.175369
2259296482.4121,27.161404,-135.15987
2262311557.7889,26.981419,177.17195
2265326633.1658,27.074705,133.13438
2268341708.5427,26.917915,87.481316
2271356783.9196,27.33255,39.539993
2274371859.2965,27.439354,-4.750515
2277386934.6734,27.230387,-51.119663
2280402010.0503,27.391212,-97.475563
2283417085.4271,26.743427,-144.12776
2286432160.804,26.711813,170.01556
2289447236.1809,26.647043,126.35668
2292462311.5578,26.945015,81.849617
2295477386.9347,26.832521,37.327923
2298492462.3116,27.207016,-8.5585604
2301507537.6884,27.034269,-56.94302
2304522613.0653,27.033152,-101.14833
2307537688.4422,26.885107,-149.55928
2310552763.8191,26.615372,166.43826
2313567839.196,26.496607,120.74728
2316582914.5729,26.540842,75.253624
2319597989.9497,26.803484,30.283386
2322613065.3266,26.837543,-15.937737
2325628140.7035,26.680414,-64.181633
2328643216.0804,26.656403,-110.32435
2331658291.4573,26.276987,-156.70314
2334673366.8342,26.035807,159.43224
2337688442.2111,25.787273,115.02569
2340703517.5879,26.110043,70.922455
2343718592.9648,26.046434,24.466923
2346733668.3417,25.94688,-22.986736
2349748743.7186,25.339359,-67.036324
2352763819.0955,25.173519,-115.79337
2355778894.4724,24.84396,-160.66966
2358793969.8492,24.778267,156.06873
2361809045.2261,24.478811,112.54522
2364824120.603,24.736134,67.524971
2367839195.9799,24.215631,23.787868
2370854271.3568,24.241447,-23.12203
2373869346.7337,23.80798,-66.923737
2376884422.1106,23.731131,-109.14806
2379899497.4874,23.139357,-151.27299
2382914572.8643,23.226469,169.2675
2385929648.2412,23.774672,126.73411
2388944723.6181,24.028128,83.294106
2391959798.995,24.756578,39.389561
2394974874.3719,25.130106,-6.2642622
2397989949.7487,25.444277,-53.621372
2401005025.1256,25.391043,-99.146774
2404020100.5025,25.462181,-141.13692
2407035175.8794,25.880913,172.63681
2410050251.2563,26.269445,126.00085
2413065326.6332,26.524908,81.853874
2416080402.0101,27.01885,34.071671
2419095477.3869,26.970091,-12.750703
2422110552.7638,27.114042,-61.264584
2425125628.1407,27.3724,-104.30961
2428140703.5176,27.156191,-152.45537
2431155778.8945,27.260729,163.04257
2434170854.2714,27.331148,116.67836
2437185929.6482,27.572689,70.361015
2440201005.0251,27.504856,23.719999
2443216080.402,27.462929,-21.234665
2446231155.7789,27.490559,-67.726944
2449246231.1558,27.537197,-115.45429
2452261306.5327,27.476868,-161.16019
2455276381.9095,27.607222,152.46544
2458291457.2864,27.554508,108.79025
2461306532.6633,27.781889,61.037891
2464321608.0402,28.061159,16.205742
2467336683.4171,27.78516,-30.203053
2470351758.794,27.936426,-76.020508
2473366834.1709,27.754732,-120.87457
2476381909.5477,27.521782,-169.14714
2479396984.9246,27.112476,148.40651
2482412060.3015,27.702795,100.72493
2485427135.6784,27.48678,56.118042
2488442211.0553,27.614176,10.348915
2491457286.4322,27.491415,-37.463436
2494472361.809,27.61223,-81.175209
2497487437.1859,27.778498,-129.79306
2500502512.5628,27.511421,-175.03535
2503517587.9397,27.481136,139.42656
2506532663.3166,27.776985,94.801758
2509547738.6935,27.450369,48.551949
2512562814.0704,27.828703,4.7870622
2515577889.4472,28.260086,-42.513565
2518592964.8241,27.921656,-88.681923
2521608040.201,27.760908,-134.89133
2524623115.5779,27.804928,179.45923
2527638190.9548,27.835083,133.54073
2530653266.3317,27.451126,87.955338
2533668341.7085,27.482843,43.113586
2536683417.0854,27.963955,-4.6496639
2539698492.4623,27.596495,-48.311043
2542713567.8392,27.591831,-95.202042
2545728643.2161,27.504545,-139.63992
2548743718.593,27.606791,174.20428
2551758793.9698,27.420687,126.82556
2554773869.3467,27.427795,82.453262
2557788944.7236,27.787018,35.897568
2560804020.1005,27.908781,-9.0767508
2563819095.4774,27.890768,-58.421314
2566834170.8543,27.333206,-103.34145
2569849246.2312,27.425602,-148.39626
2572864321.608,27.404835,168.77954
2575879396.9849,27.390293,122.05603
2578894472.3618,27.633667,76.548134
2581909547.7387,27.554285,31.543146
2584924623.1156,27.596983,-14.275471
2587939698.4925,27.556835,-60.989384
2590954773.8693,27.63179,-107.95035
2593969849.2462,27.673983,-155.07164
2596984924.6231,27.237637,160.85184
2600000000,27.446293,117.94852
END
</div>
    <textarea id = "dataIN"></textarea>
    <button id = "plotButton">PLOT</button>
    <canvas id = "mainPlot"></canvas>
    
<script>
    mainPlot = document.getElementById("mainPlot");
    mainPlot.width = 300;
    mainPlot.height = 300;
    h = mainPlot.height;
    document.getElementById("dataIN").value =document.getElementById("sampledata").innerHTML;
    document.getElementById("plotButton").onclick = function(){
        var rawString = document.getElementById("dataIN").value;
        var rawArray = rawString.split("\n");
        unitString = "";
        for(var index = 0 ;index < rawArray.length;index++){
            if(rawArray[index].startsWith("BEGIN")){
                unitString = rawArray[index+1];
                firstIndex = index+2;
            }
            if(rawArray[index].startsWith("END")){
                endIndex = index;
            }
        }
        freq = [];
        mag = [];
        arg = [];
        for(var index = firstIndex;index < endIndex;index++){
            var raw = rawArray[index].split(",");
            freq.push(raw[0]);
            mag.push(raw[1]);
            arg.push(raw[2]);
        }
        n = freq.length;
        mainPlot = document.getElementById("mainPlot");
        mainPlot.width = 100 + n;
        mainPlot.height = 300;
        ctx = mainPlot.getContext("2d");
        ctx.strokeStyle = "black";
        ctx.lineWidth = 3;
        ctx.clearRect(50,50,300,300);
        ctx.strokeRect(50,50,200,200);
        y0 = 150;
        x0 = 50;
        Smin = 20;
        Smax = 30;    
        ctx.beginPath();
        ctx.moveTo(x0,y0);
        for(var index = 1;index < n;index++){
            y = (Smax - parseFloat(mag[index]) )*h/(Smax - Smin);
            console.log(y);
            ctx.lineTo(x0 + index,y);
        }
        ctx.stroke();
        ctx.closePath();

        yGridDelta = 5;

    }
 
    </script>
    <style>
        html{
            background-color: yellow;
        }
        #dataIN{
            position:absolute;
            left:10px;
            top:100px;
            width:300px;
            height:500px;
            background-color:white;
        }
        #mainPlot{
            position:absolute;
            right:100px;
            top:100px;
            background-color:white;            
        }
        #plotButton{
            position:absolute;
            left:200px;
            top:50px;
        }
    </style>
</body>
</html>